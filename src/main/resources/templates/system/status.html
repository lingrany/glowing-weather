<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»ŸçŠ¶æ€ç›‘æ§ - å¤©æ°”é¢„æŠ¥ç³»ç»Ÿ</title>
    <link rel="stylesheet" th:href="@{/css/style.css?v=3}">
    <link rel="stylesheet" th:href="@{/css/system.css?v=1}">
</head>
<body>
<div class="container">
    <div class="header-links">
        <a href="/" class="back-link">&larr; è¿”å›é¦–é¡µ</a>
        <a href="/user/profile" class="profile-link">ä¸ªäººè®¾ç½®</a>
    </div>
    
    <h1>ğŸ–¥ï¸ ç³»ç»ŸçŠ¶æ€ç›‘æ§</h1>

    <!-- æˆåŠŸ/é”™è¯¯æ¶ˆæ¯ -->
    <div th:if="${message}" class="success-message">
        <p th:text="${message}"></p>
    </div>
    
    <div th:if="${error}" class="error-message">
        <p th:text="${error}"></p>
    </div>

    <!-- ç³»ç»Ÿä¿¡æ¯ -->
    <div class="section">
        <h2>ğŸ“Š ç³»ç»Ÿä¿¡æ¯</h2>
        <div class="info-grid">
            <div th:each="entry : ${systemInfo}" class="info-card">
                <h3 th:text="${entry.key}"></h3>
                <p th:text="${entry.value}"></p>
            </div>
        </div>
    </div>

    <!-- å†…å­˜ä¿¡æ¯ -->
    <div class="section">
        <h2>ğŸ’¾ å†…å­˜ä½¿ç”¨æƒ…å†µ</h2>
        <div class="info-grid">
            <div th:each="entry : ${memoryInfo}" class="info-card" 
                 th:classappend="${entry.key == 'å†…å­˜ä½¿ç”¨ç‡' ? 'memory-usage' : ''}">
                <h3 th:text="${entry.key}"></h3>
                <p th:text="${entry.value}"></p>
            </div>
        </div>
    </div>

    <!-- ç¼“å­˜ä¿¡æ¯ -->
    <div class="section">
        <h2>ğŸ—„ï¸ ç¼“å­˜çŠ¶æ€</h2>
        <div class="info-grid">
            <div th:each="entry : ${cacheInfo}" class="info-card cache-card">
                <h3 th:text="${entry.key}"></h3>
                <p th:text="${entry.value}" class="cache-status"></p>
            </div>
        </div>
        
        <!-- ç¼“å­˜ç®¡ç† -->
        <div class="cache-management">
            <h3>ç¼“å­˜ç®¡ç†</h3>
            <form th:action="@{/system/clear-cache}" method="post" 
                  onsubmit="return confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç¼“å­˜å—ï¼Ÿè¿™å°†å¯¼è‡´ä¸‹æ¬¡è¯·æ±‚æ—¶é‡æ–°è·å–æ•°æ®ã€‚')">
                <button type="submit" class="clear-cache-btn">ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰ç¼“å­˜</button>
            </form>
            <p class="cache-note">
                ğŸ’¡ æç¤ºï¼šæ¸…é™¤ç¼“å­˜åï¼Œä¸‹æ¬¡è·å–å¤©æ°”æ•°æ®æ—¶ä¼šé‡æ–°ä»APIè·å–æœ€æ–°ä¿¡æ¯ï¼Œå¯èƒ½ä¼šç¨æ…¢ä¸€äº›ã€‚
            </p>
        </div>
    </div>

    <!-- ç³»ç»Ÿå¥åº·çŠ¶æ€ -->
    <div class="section">
        <h2>ğŸ’š ç³»ç»Ÿå¥åº·çŠ¶æ€</h2>
        <div class="health-status">
            <div class="health-item">
                <span class="health-indicator healthy"></span>
                <span>å¤©æ°”APIæœåŠ¡</span>
                <span class="health-text">æ­£å¸¸</span>
            </div>
            <div class="health-item">
                <span class="health-indicator healthy"></span>
                <span>é‚®ä»¶æœåŠ¡</span>
                <span class="health-text">æ­£å¸¸</span>
            </div>
            <div class="health-item">
                <span class="health-indicator healthy"></span>
                <span>ç¼“å­˜ç³»ç»Ÿ</span>
                <span class="health-text">æ­£å¸¸</span>
            </div>
            <div class="health-item">
                <span class="health-indicator healthy"></span>
                <span>å®šæ—¶ä»»åŠ¡</span>
                <span class="health-text">æ­£å¸¸</span>
            </div>
        </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <div class="section">
        <h2>âš¡ å¿«é€Ÿæ“ä½œ</h2>
        <div class="quick-actions">
            <a href="/user/profile" class="action-btn">ğŸ‘¤ ç”¨æˆ·ç®¡ç†</a>
            <a href="/map" class="action-btn">ğŸ—ºï¸ å¤©æ°”åœ°å›¾</a>
            <a href="/" class="action-btn">ğŸ  è¿”å›é¦–é¡µ</a>
        </div>
    </div>
</div>

<script>
// è‡ªåŠ¨åˆ·æ–°é¡µé¢ï¼ˆæ¯30ç§’ï¼‰
setTimeout(function() {
    location.reload();
}, 30000);

// æ˜¾ç¤ºæœ€åæ›´æ–°æ—¶é—´
document.addEventListener('DOMContentLoaded', function() {
    const now = new Date();
    const timeStr = now.toLocaleString('zh-CN');
    const footer = document.createElement('div');
    footer.className = 'last-updated';
    footer.innerHTML = '<p>æœ€åæ›´æ–°æ—¶é—´: ' + timeStr + ' | é¡µé¢å°†åœ¨30ç§’åè‡ªåŠ¨åˆ·æ–°</p>';
    document.querySelector('.container').appendChild(footer);
});
</script>
</body>
</html>